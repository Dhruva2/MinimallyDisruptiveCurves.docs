<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/MinimallyDisruptiveCurves.docs/libs/katex/katex.min.css"> <link rel=stylesheet  href="/MinimallyDisruptiveCurves.docs/libs/highlight/github.min.css"> <link rel=stylesheet  href="/MinimallyDisruptiveCurves.docs/css/jtd.css"> <link rel=icon  href="/MinimallyDisruptiveCurves.docs/assets/favicon.ico"> <title>MinimallyDisruptiveCurves.jl: Documentation</title> <div class=page-wrap > <div class=side-bar > <div class=header > <a href="/MinimallyDisruptiveCurves.docs/" class=title > User guide </a> </div> <label for=show-menu  class=show-menu >MENU</label> <input type=checkbox  id=show-menu  role=button > <div class=menu  id=side-menu > <ul class=menu-list > <li class="menu-list-item "><a href="/MinimallyDisruptiveCurves.docs/" class="menu-list-link ">Home</a> <li class="menu-list-item "><a href="/MinimallyDisruptiveCurves.docs/installation/"class="menu-list-link ">Installation</a> <li class="menu-list-item "><a href="/MinimallyDisruptiveCurves.docs/menu1/" class="menu-list-link ">How it works</a> <li class="menu-list-item "><a href="/MinimallyDisruptiveCurves.docs/sceptic/" class="menu-list-link ">Q&A with a sceptic</a> <li class="menu-list-item "><a href="/MinimallyDisruptiveCurves.docs/Audience_questions/" class="menu-list-link ">Questions from the Audience</a> <li class="menu-list-item "><a href="/MinimallyDisruptiveCurves.docs/menu2/" class="menu-list-link ">Examples</a> <li class="menu-list-item active"><a href="/MinimallyDisruptiveCurves.docs/menu3/" class="menu-list-link active">Tips & Tricks</a> <ul class="menu-list-child-list "> <li class="menu-list-item "><a href="#" class=menu-list-link >Submenu</a> </ul> </ul> </div> <div class=footer > This is <em>Just the docs</em>, adapted from the <a href="https://github.com/pmarsceill/just-the-docs" target=_blank >Jekyll theme</a>. </div> </div> <div class=main-content-wrap > <div class=main-content > <div class=main-header > <a id=github  href="https://github.com/Dhruva2/MinimallyDisruptiveCurves.jl">MinimallyDisruptiveCurves.jl on GitHub</a> </div> <div class=franklin-content ><h1 id=tips_tricks_agony_aunt ><a href="#tips_tricks_agony_aunt" class=header-anchor >Tips, Tricks &amp; Agony Aunt</a></h1> <div class=franklin-toc ><ol><li><a href="#tips_tricks">Tips &amp; Tricks</a><ol><li><a href="#the_initial_direction_is_important">The initial direction is important</a><li><a href="#the_momentum_usually_isnt_important">The momentum usually isn&#39;t important.</a><li><a href="#jumpstart_on_master_and_coming_in_v03">Jumpstart &#40;on master, and coming in v0.3&#41;</a><li><a href="#exploit_parameter_biasing_and_the_logabs_transform">Exploit parameter biasing and the logabs transform</a><li><a href="#run_curves_twice">Run curves twice</a></ol><li><a href="#agony_aunt">Agony aunt</a><ol><li><a href="#curve_doesnt_get_started_when_evolving">Curve doesn&#39;t get started when evolving</a><li><a href="#curve_is_sawtoothing">Curve is sawtoothing</a><li><a href="#curve_is_slow_to_generate">Curve is slow to generate</a><li><a href="#curve_generation_hangs">Curve generation hangs</a></ol></ol></div> <h2 id=tips_tricks ><a href="#tips_tricks" class=header-anchor >Tips &amp; Tricks</a></h2> <h3 id=the_initial_direction_is_important ><a href="#the_initial_direction_is_important" class=header-anchor >The initial direction is important</a></h3> <p>Let&#39;s call it <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">\delta \theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>. If model sensitivity to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">\delta \theta</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> is high, then ...</p> <ul> <li><p>if you&#39;re lucky the curve will change direction quickly onto a better &#40;more insensitive&#41; direction</p> <li><p>if you&#39;re unlucky it won&#39;t find a better direction, and will evolve in a slow, jaggedly meandering manner that is disruptive of model behaviour.</p> <li><p>if it involves lots of parameters, it might be hard to interpret</p> </ul> <p>Note that sensitivity is quantified by:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><msup><mi>θ</mi><mi>T</mi></msup><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>C</mi><mo stretchy=false >[</mo><msup><mi>θ</mi><mo>∗</mo></msup><mo stretchy=false >]</mo><mi>δ</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex"> \delta \theta^T \nabla^2 C[\theta^*] \delta \theta </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mclose >]</span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span></span> <p>The bigger this is, the more sensitive the direction. If you don&#39;t have an intuitively motivated initial direction, you could <strong>follow these steps</strong> &#40;which are explicitly done in the NFKB example notebook&#41;:</p> <div class=unobtrusivebox ><ol> <li><p>Fix parameters you&#39;re not interested in &#40;if any&#41;.</p> <li><p>Generate an approximation of the Hessian <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>C</mi><mo stretchy=false >[</mo><msup><mi>θ</mi><mo>∗</mo></msup><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">\nabla^2 C[\theta^*]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mclose >]</span></span></span></span> &#40;finite difference, automatic differentiation, <code>l2_hessian</code>, or otherwise&#41;. </p> <li><p>Solve the <a href="https://en.wikipedia.org/wiki/Quadratically_constrained_quadratic_program">QCQP</a> using e.g. JUMP.jl:</p> </ol> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo><mi>min</mi><mo>⁡</mo></mo><mrow><mi>δ</mi><mi>θ</mi></mrow></munder><mi>δ</mi><msup><mi>θ</mi><mi>T</mi></msup><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>C</mi><mo stretchy=false >[</mo><msup><mi>θ</mi><mo>∗</mo></msup><mo stretchy=false >]</mo><mi>δ</mi><mi>θ</mi><mo>+</mo><mi>λ</mi><mi mathvariant=normal >∥</mi><mi>δ</mi><mi>θ</mi><msub><mi mathvariant=normal >∥</mi><mn>1</mn></msub><mspace width=1em /><mtext>subject to</mtext><mspace width=1em /><mi mathvariant=normal >∥</mi><mi>δ</mi><mi>θ</mi><msubsup><mi mathvariant=normal >∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><mn>1.</mn></mrow><annotation encoding="application/x-tex"> \min_{\delta \theta} \delta \theta^T \nabla^2 C[\theta^*] \delta \theta + \lambda \| \delta \theta \|_1 \quad \text{subject to} \quad \| \delta \theta \|_2^2 = 1. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.6434389999999999em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class=mord ><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class=mclose >]</span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class=mord >∥</span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=mord ><span class=mord >∥</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:1em;"></span><span class="mord text"><span class=mord >subject to</span></span><span class=mspace  style="margin-right:1em;"></span><span class=mord >∥</span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class=mord ><span class=mord >∥</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >.</span></span></span></span></span> <ul> <li><p><em>The value of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda &gt;0 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">λ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> is proportional to your desire to involve only a small number of parameters in the initial direction: it is a sparsity-encouraging &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=script >L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ><span class="mord mathcal">L</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#41; regularisation term.</em></p> <li><p><em>If <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">λ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> then the solution is just the eigenvector with the smallest eigenavalue.</em> </p> <li><p>Otherwise, this is non-convex, and will usually have multiple local solutions, depending on the initial condition of the optimisation problem. Each of these local solutions is a great candidate for an MD curve&#33; &#40;again, see the NFKB or STG neuron examples for an actual implementation.&#41;</p> <li><p>Set extremely small &#40;e.g. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>1</mn><mi>e</mi><mo>−</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">&lt;1e-5</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class="mord mathdefault">e</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5</span></span></span></span>&#41; components of the initial direction vector to zero. This potentially saves the curve generator some trouble at the beginning</p> </ul></div> <p><br/> <br/></p> <div class=infobox ><strong>By the way</strong> <br/> I will add better functionality for easily synthesising good initial directions at some point. Check the examples for now.</div> <h3 id=the_momentum_usually_isnt_important ><a href="#the_momentum_usually_isnt_important" class=header-anchor >The momentum usually isn&#39;t important.</a></h3> <p>If it&#39;s too low, the curve will terminate early &#40;as soon as cost &gt; momentum&#41;. It will also slow the evolution of the curve numerically. <strong>But</strong> it can be more accurate &#40;providing a more minimally disruptive curve&#41;.</p> <h3 id=jumpstart_on_master_and_coming_in_v03 ><a href="#jumpstart_on_master_and_coming_in_v03" class=header-anchor >Jumpstart &#40;on master, and coming in v0.3&#41;</a></h3> <p>The differential equation evolving the minimally disruptive curve can be quite ill conditioned near the start of the curve. This means it can take a lot of time to evolve a small amount at the beginning. To bypass this, you can take an MDCProblem and transform it so that it <em>jumpstarts</em>:</p> <pre><code class="julia hljs">new_prob = jumpstart(mdcprob::MDCProblem, <span class=hljs-number >1e-2</span>, <span class=hljs-literal >true</span>)</code></pre>
<p>Essentially, the starting point of the curve solved by new_prob is now <code>mdcprob.p0 &#43; &#40;1e-2&#41;mdcprob.dp0</code>. The third, Boolean, argument specifies whether the solver should attempt to calculate a new initial curve direction, or just use <code>mdcprob.dp0</code>. You can also figure out an initial direction yourself, and modify it in <code>new_prob</code> through</p>
<pre><code class="julia hljs">new_prob.dp0 = [<span class=hljs-number >1.</span>, <span class=hljs-number >2.</span>, <span class=hljs-number >3.</span>, ...]</code></pre>
<h3 id=exploit_parameter_biasing_and_the_logabs_transform ><a href="#exploit_parameter_biasing_and_the_logabs_transform" class=header-anchor >Exploit parameter biasing and the logabs transform</a></h3>
<div class=unobtrusivebox ><p><strong>Questions</strong></p>
<ol>
<li><p><em>What counts as a &#39;big&#39; change in a parameter?</em> </p>

<li><p><em>Is a big change the same across different model parameters?</em></p>

</ol>
<p><strong>Answers</strong></p>
<ol>
<li><p>Very thorny issue. Depends on the &#40;questions being asked of the&#41; model.</p>

<li><p>No.</p>

</ol></div>
<p>MinimallyDisruptiveCurves.jl is using the L2 metric on parameter space to <em>get as far away as possible from the initial parameters while minimising disruption to model behaviour</em>.</p>
<p>But maybe a small &#40;absolute&#41; <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">L2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class=mord >2</span></span></span></span> change in parameter <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> would be very significant for you, and a big <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">L2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class=mord >2</span></span></span></span> change in parameter <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> would not be.  </p>
<ul>
<li><p>If your parameters don&#39;t cross zero &#40;i.e. they are only positive or negative&#41; then use the <code>logabs_transform</code> to consider relative, rather than absolute <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">L2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class=mord >2</span></span></span></span> changes in parameters. IE <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.01</mn><mo>→</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">0.01 \to 0.02</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >0</span><span class=mord >2</span></span></span></span> is the same as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo>→</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">100 \to 200</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >0</span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span><span class=mord >0</span><span class=mord >0</span></span></span></span>. </p>

<li><p>Otherwise, use <code>bias_transform</code> to weight the importance of absolute changes in different parameters. The more uniform this is, <strong>the faster the MD curve will evolve</strong>, heuristically.</p>

</ul>
<p>Using these, and other transformation structures, are demonstrated in the Examples notebook: transforming_costs.ipynb .</p>
<h3 id=run_curves_twice ><a href="#run_curves_twice" class=header-anchor >Run curves twice</a></h3>
<p>...if you want to maximise numerical accuracy.</p>
<p>Check which parameters are significantly changing over the curve, and fix all the other parameters using <code>only_free_parametes</code>, for the second run.</p>
<p>Of course....your curve might rely on apparently small changes in &#39;unimportant&#39; parameters on the first curve. But that&#39;s useful information&#33;</p>
<h2 id=agony_aunt ><a href="#agony_aunt" class=header-anchor >Agony aunt</a></h2>
<h3 id=curve_doesnt_get_started_when_evolving ><a href="#curve_doesnt_get_started_when_evolving" class=header-anchor >Curve doesn&#39;t get started when evolving</a></h3>
<p>In other words, when you set the Verbose callback to tell you how far along the curve you are, the distance from the origin grows very slowly / stalls close to zero.</p>
<ul>
<li><p>Use a fixed timestep method when calling <code>evolve</code>:</p>

</ul>
<pre><code class="julia hljs">evolve(mdcprob, Tsit5, ...;  adaptive = <span class=hljs-literal >false</span>, ...)</code></pre>
<p>or</p>
<pre><code class="julia hljs">evolve(mdcprob, Tsit5, ...;  adaptive = <span class=hljs-literal >false</span>, dt = <span class=hljs-number >0.05</span>, ...)</code></pre>
<p>or</p>
<pre><code class="julia hljs">evolve(mdcprob, Tsit5, ...; dtmin = <span class=hljs-number >0.05</span>, ...)</code></pre>
<p>where the <code>dt</code> keyword argument is optional and 0.05 is fairly arbitrary.</p>
<div class=infobox ><p><strong>By the way</strong> <br/></p>
<ul>
<li><p>Usually the cause of this problem is stiffness in the differential equation that generates the curve, when close to the origin.</p>

<li><p>For some discussion of this, see the fourth question on <a href="/MinimallyDisruptiveCurves.docs/sceptic/">Q&amp;A with a sceptic</a>.</p>

<li><p>Heuristically, adaptive timestep solvers sometimes get worried about the stiffness, and start proposing iteratively smaller step sizes to control numerical error at the origin. If they bludgeon through the first tiny section of curve, this disappears.</p>

</ul></div>
<h3 id=curve_is_sawtoothing ><a href="#curve_is_sawtoothing" class=header-anchor >Curve is sawtoothing</a></h3>
<p>Default settings in the <code>evolve</code> function &#40;which generates MD curves&#41; are to have <code>momentum_tol &#61; 1e-3</code>. What is this? </p>
<ul>
<li><p>Functionally, it helps with accuracy of the curve evolution.</p>

<li><p>Mathematically &#40;not something to worry about in this context&#41; it uses an algebraic identity on what the costate &#40;i.e. momentum&#41; should be to occasionally reset the costate. </p>

</ul>
<p>There is a bug whereby if the MD curve cannot find any new good directions <strong>and</strong> it resets the costate, it can double back on itself and violate the monotonic increase in distance from initial parameter values. You can stop this by setting the keyword argument:</p>
<pre><code class="julia hljs">evolve(...; momentum_tol = <span class=hljs-literal >NaN</span>)</code></pre>
<p>I&#39;ll fix this at some point. Pragmatically it means the curve can&#39;t find a direction that gets further away from the origin, at the point of the sawtooth.</p>
<h3 id=curve_is_slow_to_generate ><a href="#curve_is_slow_to_generate" class=header-anchor >Curve is slow to generate</a></h3>
<ul>
<li><p>Make sure you have optimised the gradient calculation of your cost function. A gnarly curve might take e.g. 5000 evaluations of this, which is the dominant source of compute time.</p>

<li><p>Increase the momentum by two orders of magnitude.</p>

</ul>
<h3 id=curve_generation_hangs ><a href="#curve_generation_hangs" class=header-anchor >Curve generation hangs</a></h3>
<ul>
<li><p>Does the span of your curve cross zero? IE is it of the form <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mo>−</mo><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(-a, b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathdefault">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class=mclose >)</span></span></span></span> where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a,b &gt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>. Sometimes on Pluto, this hangs for unknown reasons probably to do with multithreading. Try generating two curves: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mo>−</mo><mi>a</mi><mo separator=true >,</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(-a, 0)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >−</span><span class="mord mathdefault">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(0, b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class=mclose >)</span></span></span></span> and sticking them together. </p>

</ul>
<p>More specifically, two-sided curves as above are evolved as two separate curves running on two separate threads on MinimallyDisruptiveCurves.jl. Sometimes, this doesn&#39;t seem to play nicely on Pluto.jl notebooks. </p>
<div class=page-foot >
  <div class=copyright >
    &copy; Dhruva Venkita Raman. Last modified: June 01, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>
</div>
    </div> 
    </div> 
    </div> <!-- end of class page-wrap-->